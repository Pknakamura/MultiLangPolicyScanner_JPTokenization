（緊急）BIND 9.xの脆弱性（過剰なCPU負荷の誘発）について（CVE-2023-4408）   - フルリゾルバー（キャッシュDNSサーバー）／権威DNSサーバーの双方が対象、     バージョンアップを強く推奨 - DNS関連技術情報のトップへ戻る ---------------------------------------------------------------------
■（緊急）BIND 9.xの脆弱性（過剰なCPU負荷の誘発）について（CVE-2023-4408）
  - フルリゾルバー（キャッシュDNSサーバー）／権威DNSサーバーの双方が対象、
    バージョンアップを強く推奨 -

                                株式会社日本レジストリサービス（JPRS）
                                            初版作成 2024/02/14（Wed）
---------------------------------------------------------------------
▼概要

  BIND 9.xにおける実装上の不具合により、namedに対する外部からの攻撃が
  可能となる脆弱性が、開発元のISCから発表されました。本脆弱性により
  namedにおいて過剰なCPU負荷が誘発され、結果としてサービスの停止や品質
  低下などが発生する可能性があります。

  本脆弱性はBIND 9.0.0以降のすべてのバージョンのBIND 9が対象となり、か
  つ、フルリゾルバー（キャッシュDNSサーバー）及び権威DNSサーバーの双方
  が対象となることから、対象が広範囲にわたっています。

  該当するBIND 9のパッケージを利用しているユーザーは、各ディストリビュー
  ションベンダーからリリースされる情報の収集やバージョンアップなど、適
  切な対応を速やかに取ることを強く推奨します。

▼詳細

▽本脆弱性の概要

  DNSの通信においてやりとりされるDNSメッセージ（問い合わせ・応答）は、
  権威DNSサーバーやフルリゾルバーによって解析されます。

  BIND 9.xのDNSメッセージを解析するコードには計算量が過度に多い部分が
  存在しており、特別に作成されたDNSメッセージを送りつけることで、named
  のCPU負荷を過剰に高められる可能性があります。

  これを利用し、外部の攻撃者がnamedプロセスに本件を誘発するDNSメッセー
  ジを送り続けることでCPU負荷を増大させ、過負荷に陥らせることにより、
  namedを含むシステム全体のパフォーマンスの低下や停止が誘発される可能
  性があります。

  本脆弱性は権威DNSサーバーとフルリゾルバーの双方、及びDNS問い合わせと
  応答の双方の取り扱いに影響します。

▽対象となるバージョン

  本脆弱性は、BIND 9.0.0以降のすべてのバージョンのBIND 9が該当します。

  ・9.18系列：9.18.0-9.18.21
  ・それ以外の系列：9.0.0-9.16.45

  なお、ISCではBIND 9.11.37より前のバージョンにおいて、本脆弱性の評価を
  実施していません。

▽影響範囲

  ISCは、本脆弱性の深刻度（Severity）を「高（High）」と評価しています。

  JPRSでは、本脆弱性の内容と影響について検討した結果、DNSの運用に与え
  る影響が大きいと判断し、緊急の注意喚起として情報提供します。本脆弱性
  は、

  ・フルリゾルバー及び権威DNSサーバーの双方が対象となること

  ・9.0.0以降のすべてのバージョンのBIND 9が対象となること

  ・問い合わせと応答の双方で脆弱性をトリガー可能であること

  ・namedの設定ファイル（named.conf）によるアクセスコントロール（ACL）
    や設定オプションの変更では、影響を回避・軽減できないこと

  などから、広い範囲での適切な緊急対策が必要になります。

  本脆弱性については、以下の脆弱性情報[*1]も併せてご参照ください。

  [*1] CVE Record | CVE
       < https://www.cve.org/CVERecord?id=CVE-2023-4408 >

▼一時的な回避策

  本脆弱性の一時的な回避策は存在しません。

▼解決策

  本脆弱性を修正したパッチバージョン（BIND 9.18.24/9.16.48）への更新、
  あるいは、各ディストリビューションベンダーからリリースされる更新の適
  用を、速やかに実施してください。

▼参考リンク

  以下に、ISCから発表されている情報へのリンクを記載します。また、各ディ
  ストリビューションベンダーからの情報や前述のCVEの情報なども確認の上、
  適切な対応を取ることを強く推奨します。

  - ISC

   セキュリティアドバイザリ

    CVE-2023-4408: Parsing large DNS messages may cause excessive CPU
                   load
    < https://kb.isc.org/docs/cve-2023-4408 >

   パッチバージョンの入手先

    BIND 9.18.24
    < https://ftp.isc.org/isc/bind9/9.18.24/bind-9.18.24.tar.xz >

    BIND 9.16.48
    < https://ftp.isc.org/isc/bind9/9.16.48/bind-9.16.48.tar.xz >

▼連絡先

  本文書に関するお問い合わせは < dnstech-info@jprs.co.jp > までご連絡くだ
  さい。

---------------------------------------------------------------------
▼更新履歴
  2024/02/14 11:00 初版作成 株式会社日本レジストリサービス　Copyright©2001-2024 Japan Registry Services Co., Ltd.