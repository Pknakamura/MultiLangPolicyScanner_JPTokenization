（緊急）BIND 9.xの脆弱性（DNSサービスの停止）について（CVE-2023-5679）   - serve-staleとDNS64を共に有効にしている場合のみ対象、     バージョンアップを強く推奨 - DNS関連技術情報のトップへ戻る ---------------------------------------------------------------------
■（緊急）BIND 9.xの脆弱性（DNSサービスの停止）について（CVE-2023-5679）
  - serve-staleとDNS64を共に有効にしている場合のみ対象、
    バージョンアップを強く推奨 -

                                株式会社日本レジストリサービス（JPRS）
                                            初版作成 2024/02/14（Wed）
---------------------------------------------------------------------
▼概要

  BIND 9.xにおける実装上の不具合により、namedに対する外部からのサービ
  ス不能（DoS）攻撃が可能となる脆弱性が、開発元のISCから発表されました。
  本脆弱性により、提供者が意図しないDNSサービスの停止が発生する可能性
  があります。

  該当するBIND 9のパッケージを利用しているユーザーは、各ディストリビュー
  ションベンダーからリリースされる情報の収集やバージョンアップなど、適
  切な対応を速やかに取ることを強く推奨します。

  本脆弱性はnamedにおいて、serve-stale（後述）とDNS64（後述）を共に有
  効に設定している場合のみ対象となります（いずれもデフォルトでは無効）。

▼詳細

▽本脆弱性の概要

  serve-staleはRFC 8767で定義される、DDoS攻撃や事故などで権威DNSサーバー
  から応答が得られなかった場合に期限切れのキャッシュデータを活用して、
  名前解決を継続するための機能です。serve-staleはデフォルトで無効になっ
  ており、namedの設定ファイル（通常はnamed.conf）のほか、rndcコマンド
  で有効に変更できます。

  DNS64はRFC 6147で定義される、AレコードからAAAAレコードを合成するため
  の仕組みです。RFC 6146で定義されるステートフルNAT64と組み合わせるこ
  とにより、IPv6アドレスのみを持つクライアントからIPv4アドレスのみを持
  つサーバーへの、ドメイン名を用いた透過的なアクセスを実現できます。

  BIND 9.xの実装には不具合があり、serve-staleとDNS64の不適切な相互作用
  により、namedにおいてserve-staleとDNS64の双方が有効に設定されている
  場合、serve-stale機能が使われるドメイン名の名前解決の実行中に、named
  が異常終了する可能性があります[*1]。

  [*1] 本脆弱性によりnamedが異常終了した場合、assertion failureを引き
       起こした旨のメッセージがログに出力されます。

  そのため、外部の攻撃者がこの状況を発生させることができた場合、当該サー
  バーのDNSサービスを停止させることが可能になります。

▽対象となるバージョン

  本脆弱性は、以下のバージョンのBIND 9が該当します。

  ・9.18系列：9.18.0-9.18.21
  ・9.16系列：9.16.12-9.16.45

▽影響範囲

  ISCは、本脆弱性の深刻度（Severity）を「高（High）」と評価しています。

  本脆弱性はnamedにおいて、serve-staleとDNS64が共に有効に設定されてい
  る場合のみ対象となります（いずれもデフォルトでは無効）。

  本脆弱性については、以下の脆弱性情報[*2]も併せてご参照ください。

  [*2] CVE Record | CVE
       < https://www.cve.org/CVERecord?id=CVE-2023-5679 >

▼一時的な回避策

  namedの設定ファイル（通常はnamed.conf）においてstale-cache-enableと
  stale-answer-enableオプションを共にnoに指定してserve-stale機能を無効
  にするか、DNS64を無効にすることで、本脆弱性を回避できます。

▼解決策

  本脆弱性を修正したパッチバージョン（BIND 9.18.24/9.16.48）への更新、
  あるいは、各ディストリビューションベンダーからリリースされる更新の適
  用を、速やかに実施してください。

▼参考リンク

  以下に、ISCから発表されている情報へのリンクを記載します。また、各ディ
  ストリビューションベンダーからの情報や前述のCVEの情報なども確認の上、
  適切な対応を取ることを強く推奨します。

  - ISC

   セキュリティアドバイザリ

    CVE-2023-5679: Enabling both DNS64 and serve-stale may cause an
                   assertion failure during recursive resolution
    < https://kb.isc.org/docs/cve-2023-5679 >

   パッチバージョンの入手先

    BIND 9.18.24
    < https://ftp.isc.org/isc/bind9/9.18.24/bind-9.18.24.tar.xz >

    BIND 9.16.48
    < https://ftp.isc.org/isc/bind9/9.16.48/bind-9.16.48.tar.xz >

▼連絡先

  本文書に関するお問い合わせは < dnstech-info@jprs.co.jp > までご連絡くだ
  さい。

---------------------------------------------------------------------
▼更新履歴
  2024/02/14 11:00 初版作成 株式会社日本レジストリサービス　Copyright©2001-2024 Japan Registry Services Co., Ltd.